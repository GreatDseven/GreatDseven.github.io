<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="React 是一个用于构建用户界面的 JAVASCRIPT 库。React主要用于构建UI，很多人认为React 是 MVC 中的 V（视图）。React 拥有较高的性能，代码逻辑非常简单，越来越多的人已开始关注和使用它。">




  <meta name="keywords" content="React,">





  <link rel="alternate" href="/default" title="赵文博的Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.1">



<link rel="canonical" href="http://yoursite.com/2018/02/09/React/">


<meta name="description" content="React 是一个用于构建用户界面的 JAVASCRIPT 库。React主要用于构建UI，很多人认为React 是 MVC 中的 V（视图）。React 拥有较高的性能，代码逻辑非常简单，越来越多的人已开始关注和使用它。">
<meta name="keywords" content="React">
<meta property="og:type" content="article">
<meta property="og:title" content="React">
<meta property="og:url" content="http://yoursite.com/2018/02/09/React/index.html">
<meta property="og:site_name" content="赵文博的Blog">
<meta property="og:description" content="React 是一个用于构建用户界面的 JAVASCRIPT 库。React主要用于构建UI，很多人认为React 是 MVC 中的 V（视图）。React 拥有较高的性能，代码逻辑非常简单，越来越多的人已开始关注和使用它。">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-09-12T06:26:02.181Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React">
<meta name="twitter:description" content="React 是一个用于构建用户界面的 JAVASCRIPT 库。React主要用于构建UI，很多人认为React 是 MVC 中的 V（视图）。React 拥有较高的性能，代码逻辑非常简单，越来越多的人已开始关注和使用它。">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> React - 赵文博的Blog </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">赵文博的Blog</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          React
        
      </h1>

      <time class="post-time">
          Feb 09 2018
      </time>
    </header>



    
            <div class="post-content">
            <h1 style="font-size: 40px;text-align:center;color: #007cdc;">React基础知识详解</h1>

<blockquote>
<p>除组件化、虚拟 DOM 在复用以及性能上带来的一般好处外，React 思想使得开发者之间更好的分工与合作，在配合上非常顺畅，规范的接口以及极强的约束，使得整个代码结构清晰，不同开发者的代码高度一致。</p>
</blockquote>
<p>下面主要讲解 ES6 语法来写 React 组件代码，提前明确以下几点：</p>
<ul>
<li>不支持 <code>getInitialState</code> 在设置组件初始的 <code>state</code> ，可在组件的 <code>constructor</code> 中通过 <code>this.state</code> 设置，也可直接作为 <code>properties</code> 定义</li>
<li><code>propTypes、defaultProps</code> 作为 <code>properties</code> 定义，也可在组件外部通过键值对方式设置。</li>
<li>不支持 <code>mixins</code>，可以使用<em>高阶组件</em>写法，或者 <code>decorator</code>。</li>
</ul>
<h2 id="1-顶层-API"><a href="#1-顶层-API" class="headerlink" title="1. 顶层 API"></a>1. 顶层 API</h2><p>最简单的 React 组件及其渲染</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 最简单的一个组件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;div&gt; here we go &lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们可以看看React给我们提供了哪些顶层组件</span></span><br><span class="line"><span class="built_in">console</span>.log(React)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> SimpleComponent</span><br></pre></td></tr></table></figure>

<h3 id="react-js"><a href="#react-js" class="headerlink" title="react.js"></a><code>react.js</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">React.Children: <span class="built_in">Object</span></span><br><span class="line">React.Component: ReactComponent(props, context, updater)</span><br><span class="line">React.DOM: <span class="built_in">Object</span></span><br><span class="line">React.PropTypes: <span class="built_in">Object</span></span><br><span class="line">React.cloneElement: (element, props, children)</span><br><span class="line">React.createClass: (spec)</span><br><span class="line">React.createElement: (type, props, children)</span><br><span class="line">React.createFactory: (type)</span><br><span class="line">React.createMixin: (mixin)</span><br><span class="line">React.isValidElement: (object)</span><br></pre></td></tr></table></figure>

<p>Component API</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.context: <span class="built_in">Object</span></span><br><span class="line"><span class="keyword">this</span>.props: <span class="built_in">Object</span></span><br><span class="line"><span class="keyword">this</span>.refs: <span class="built_in">Object</span></span><br><span class="line"><span class="keyword">this</span>.state: <span class="built_in">Object</span></span><br><span class="line"><span class="keyword">this</span>.setState: <span class="built_in">Object</span></span><br></pre></td></tr></table></figure>

<h3 id="react-dom-js"><a href="#react-dom-js" class="headerlink" title="react-dom.js"></a><code>react-dom.js</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.findDOMNode: findDOMNode(componentOrElement)</span><br><span class="line">ReactDOM.render: ()</span><br><span class="line">ReactDOM.unmountComponentAtNode: (container)</span><br></pre></td></tr></table></figure>

<h3 id="react-dom-server-js"><a href="#react-dom-server-js" class="headerlink" title="react-dom-server.js"></a><code>react-dom-server.js</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ReactDOMServer.renderToString</span><br><span class="line">ReactDOMServer.renderToStaticMarkup</span><br></pre></td></tr></table></figure>

<h2 id="2-jsx-语法"><a href="#2-jsx-语法" class="headerlink" title="2. jsx 语法"></a>2. jsx 语法</h2><p>类似 xml 的语法，用来描述组件树</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div classname=&quot;x&quot;&gt;</span><br><span class="line">  &lt;a href=&quot;#&quot;&gt;#&lt;/a&gt;</span><br><span class="line">    &lt;component x=&quot;y&quot;&gt;1&lt;/component&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>不用 JSX，用 React 提供的 API 写的话</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">React.createElement(<span class="string">'div'</span>,&#123;</span><br><span class="line">  className:<span class="string">'x'</span></span><br><span class="line">    &#125;,[</span><br><span class="line">    React.createElement(<span class="string">'a'</span>,&#123;<span class="attr">href</span>:<span class="string">'#'</span>&#125;,<span class="string">'#'</span>),</span><br><span class="line">    React.createElement(Component,&#123;<span class="attr">x</span>:<span class="string">'y'</span>&#125;,<span class="number">1</span>);</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<h3 id="2-1-注释、命名、根元素个数、JSX-嵌入变量"><a href="#2-1-注释、命名、根元素个数、JSX-嵌入变量" class="headerlink" title="2.1 注释、命名、根元素个数、JSX 嵌入变量"></a>2.1 注释、命名、根元素个数、JSX 嵌入变量</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 组件命名遵循驼峰命名，首字母大写</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">      2. 这是代码注释</span></span><br><span class="line"><span class="comment">      也可以是多行</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> name = <span class="keyword">this</span>.props.name</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. render 方法 return 回来的根元素只能是一个，超过会报错</span></span><br><span class="line">    <span class="comment">// 4. &#123; &#125; 里面可以写JS代码</span></span><br><span class="line">    <span class="keyword">return</span> &lt;div&gt;hello, &#123;name ? name : '我是默认的'&#125;&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ComponentDemo</span><br></pre></td></tr></table></figure>

<ul>
<li>React 只有一个限制， 组件只能渲染单个根节点。如果你想要返回多个节点，它们必须被包含在同一个节点里。</li>
</ul>
<h3 id="2-2-styles"><a href="#2-2-styles" class="headerlink" title="2.2 styles"></a>2.2 styles</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StyleDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 5. 在JS文件里面给组件定义样式</span></span><br><span class="line">    <span class="keyword">var</span> MyComponentStyles = &#123;</span><br><span class="line">      color: <span class="string">'blue'</span>,</span><br><span class="line">      fontSize: <span class="string">'28px'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;div style=&#123;MyComponentStyles&#125;&gt;可以直接这样写行内样式&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> StyleDemo</span><br></pre></td></tr></table></figure>

<h3 id="2-3-JSX-SPREAD"><a href="#2-3-JSX-SPREAD" class="headerlink" title="2.3 JSX SPREAD"></a>2.3 JSX SPREAD</h3><p>可以用通过 {…obj} 来批量设置一个对象的键值对到组件的属性，注意顺序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpreadDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.props)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;h1&gt;</span><br><span class="line">        &#123;<span class="string">' '</span>&#125;</span><br><span class="line">        &#123;<span class="keyword">this</span>.props.name&#125; is a &#123;<span class="keyword">this</span>.props.type&#125;&#123;<span class="string">' '</span>&#125;</span><br><span class="line">      &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default SpreadDemo</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-属性名不能和-js-关键字冲突"><a href="#2-4-属性名不能和-js-关键字冲突" class="headerlink" title="2.4 属性名不能和 js 关键字冲突"></a>2.4 属性名不能和 js 关键字冲突</h3><p>例如：className, readOnly, htmlfor</p>
<h2 id="3-数据流：state-props-propType"><a href="#3-数据流：state-props-propType" class="headerlink" title="3. 数据流：state props propType"></a>3. 数据流：state props propType</h2><h3 id="3-1-state-amp-amp-setState"><a href="#3-1-state-amp-amp-setState" class="headerlink" title="3.1 state &amp;&amp; setState"></a>3.1 state &amp;&amp; setState</h3><p>用状态控制组件变化<br>可以把一个组件看做一个状态机, 每一次状态对应于组件的一个 ui</p>
<p><strong>组件内部的状态，可以使用 state</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StateDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    secondsElapsed: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">secondsElapsed</span>: <span class="keyword">this</span>.state.secondsElapsed + <span class="number">1</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.interval = setInterval(<span class="keyword">this</span>.tick.bind(<span class="keyword">this</span>), <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    clearInterval(<span class="keyword">this</span>.interval)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;div&gt;目前已经计时：&#123;this.state.secondsElapsed&#125;秒&lt;/div&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> StateDemo</span><br></pre></td></tr></table></figure>

<h3 id="3-2-props"><a href="#3-2-props" class="headerlink" title="3.2 props"></a>3.2 props</h3><p>通过 this.props 可以获取传递给该组件的属性值，还可以通过定义 getDefaultProps 来指定默认属性值（这是 ES5 的写法，ES6 定义组件的默认 props 可以直接写 props）</p>
<p>下面几个是 props 的常用 API：</p>
<ul>
<li><code>this.props.children</code></li>
<li><code>this.props.map</code></li>
<li><code>this.props.filter</code></li>
</ul>
<p><strong>props 是调用组件的时候传递进去的数据，一般用于组件树数据传递</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PropsDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  props = &#123;</span><br><span class="line">    title: <span class="string">'这是默认的title属性值'</span></span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.props)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;b&gt;&#123;this.props.title&#125;&lt;/b&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> PropsDemo</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件调用方式</span></span><br><span class="line"><span class="comment">// &lt;PropsDemo title="设置的标题" /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-propTypes"><a href="#3-3-propTypes" class="headerlink" title="3.3 propTypes"></a>3.3 propTypes</h3><p>通过指定 propTypes 可以校验 props 属性值的类型，校验可提升开发者体验，用于约定统一的接口规范。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, PropTypes &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PropTypesDemo</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    title: PropTypes.string.isRequired</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  props = &#123;</span><br><span class="line">    title: <span class="string">'默认的title'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;b&gt;&#123;this.props.title&#125;&lt;/b&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> PropTypesDemo</span><br></pre></td></tr></table></figure>

<h2 id="4-调用-API-定义组件"><a href="#4-调用-API-定义组件" class="headerlink" title="4. 调用 API 定义组件"></a>4. 调用 API 定义组件</h2><p>用 React.createClass 或者 React.Component 定义组件时允许传入相应的配置及组件 API 的使用，包括组件生命周期提供的一系列钩子函数。</p>
<h3 id="4-1-组件初始定义"><a href="#4-1-组件初始定义" class="headerlink" title="4.1 组件初始定义"></a>4.1 组件初始定义</h3><ul>
<li>getDefaultProps 得到默认属性对象，这个在 ES6 的时候不需要这样定义</li>
<li>propTypes 属性检验规则</li>
<li>mixins 组件间公用方法</li>
</ul>
<h3 id="4-2-初次创建组件时调用"><a href="#4-2-初次创建组件时调用" class="headerlink" title="4.2 初次创建组件时调用"></a>4.2 初次创建组件时调用</h3><ul>
<li>getInitialState 得到初始状态对象</li>
<li>render 返回组件树. 必须设置</li>
<li>componentDidMount 渲染到 dom 树中是调用，只在客户端调用，可用于获取原生节点</li>
</ul>
<h3 id="4-3-组件的属性值改变时调用"><a href="#4-3-组件的属性值改变时调用" class="headerlink" title="4.3 组件的属性值改变时调用"></a>4.3 组件的属性值改变时调用</h3><ul>
<li>componentWillReceiveProps 属性改变调用</li>
<li>shouldComponentUpdate 判断是否需要重新渲染</li>
<li>render 返回组件树. 必须设置</li>
<li>componentDidUpdate 渲染到 dom 树中是调用, 可用于获取原生节点</li>
</ul>
<h3 id="4-4-销毁组件"><a href="#4-4-销毁组件" class="headerlink" title="4.4 销毁组件"></a>4.4 销毁组件</h3><ul>
<li>componentWillUnmount 组件从 dom 销毁前调用</li>
</ul>
<h3 id="4-5-示例诠释组件全生命周期"><a href="#4-5-示例诠释组件全生命周期" class="headerlink" title="4.5 示例诠释组件全生命周期"></a>4.5 示例诠释组件全生命周期</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LifeCycle</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  Props = &#123;</span><br><span class="line">    value: <span class="string">'开始渲染'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillReceiveProps(nextProps) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillReceiveProps'</span>)</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      value: nextProps.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'shouldComponentUpdate'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUpdate(nextProps, nextState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'render'</span>)</span><br><span class="line">    <span class="keyword">return</span> &lt;span&gt;&#123;this.props.value&#125;&lt;/span&gt;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentDidMount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidUpdate(prevProps, prevState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentDidUpdate'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount(prevProps, prevState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'componentWillUnmount'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> LifeCycle</span><br></pre></td></tr></table></figure>

<p>调用组件并销毁组件示例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;;</span><br><span class="line">import LifeCycleDemo from &apos;./LifeCycleDemo&apos;;</span><br><span class="line"></span><br><span class="line">class DestroyComponent extends Component &#123;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    value:1,</span><br><span class="line">    destroyed:false</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  increase = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      value: this.state.value + 1</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  destroy = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      destroyed: true</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    if(this.state.destroyed)&#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &lt;div&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.increase&#125;&gt;每次加1&lt;/button&gt;</span><br><span class="line">        &lt;button onClick=&#123;this.destroy&#125;&gt;干掉这两个按钮&lt;/button&gt;</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">      &lt;LifeCycleDemo value=&#123;this.state.value&#125;/&gt;</span><br><span class="line">    &lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default DestroyComponent;</span><br></pre></td></tr></table></figure>

<h3 id="4-6-回顾组件的渲染过程"><a href="#4-6-回顾组件的渲染过程" class="headerlink" title="4.6 回顾组件的渲染过程"></a>4.6 回顾组件的渲染过程</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># 创建-》渲染-》销毁</span><br><span class="line"></span><br><span class="line">getDefaultProps()</span><br><span class="line">getInitialState()</span><br><span class="line">componentWillMount()</span><br><span class="line">render()</span><br><span class="line">componentDidMount()</span><br><span class="line">componentWillUnmount()</span><br><span class="line"></span><br><span class="line"># 更新组件</span><br><span class="line"></span><br><span class="line">componentWillReceiveProps()</span><br><span class="line">shouldComponentUpdate()</span><br><span class="line">componentWillUpdate()</span><br><span class="line">render()</span><br><span class="line">componentDidUpdate()</span><br></pre></td></tr></table></figure>

<h2 id="5-使用-ref-对操作-DOM"><a href="#5-使用-ref-对操作-DOM" class="headerlink" title="5. 使用 ref 对操作 DOM"></a>5. 使用 ref 对操作 DOM</h2><ul>
<li>ReactDOM.findDOMNode</li>
<li>this.refs.xxx</li>
</ul>
<p>获取 DOM 后可以方便结合现有非 react 类库的使用，通过 ref/refs 可以取得组件实例，进而取得原生节点，不过尽量通过 state/props 更新组件，不要使用该功能去更新组件的 DOM。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM, &#123; findDOMNode &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandleDOMComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="comment">// 两种方式都可以获取到元素</span></span><br><span class="line">    <span class="keyword">let</span> ele = findDOMNode(<span class="keyword">this</span>.refs.content)</span><br><span class="line">    <span class="keyword">let</span> ele2 = <span class="keyword">this</span>.refs.content</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果想用 jquery，那么这是个好时机</span></span><br><span class="line">    <span class="built_in">console</span>.log(ele)</span><br><span class="line">    <span class="built_in">console</span>.log(ele.innerHTML)</span><br><span class="line">    <span class="built_in">console</span>.log(ele2.innerHTML)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h3&gt;来吧，一起操作DOM&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;div ref="content"&gt;这是我DOM元素里面的内容&lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default HandleDOMComponent</span></span><br></pre></td></tr></table></figure>

<p>再看一个有趣的例子</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; findDOMNode &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Refs</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    red: <span class="number">0</span>,</span><br><span class="line">    green: <span class="number">0</span>,</span><br><span class="line">    pink: <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  update = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      red: findDOMNode(<span class="keyword">this</span>.refs.red).value,</span><br><span class="line">      green: findDOMNode(<span class="keyword">this</span>.refs.green).value,</span><br><span class="line">      pink: findDOMNode(<span class="keyword">this</span>.refs.pink).value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Slider ref=<span class="string">"red"</span> update=&#123;<span class="keyword">this</span>.update&#125; /&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.state.red&#125;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;Slider ref=<span class="string">"green"</span> update=&#123;<span class="keyword">this</span>.update&#125; /&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.state.green&#125;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;Slider ref=<span class="string">"pink"</span> update=&#123;<span class="keyword">this</span>.update&#125; /&gt;</span><br><span class="line">        &#123;<span class="keyword">this</span>.state.pink&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class Slider extends Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return &lt;input type="range" min="0" max="255" onChange=&#123;this.props.update&#125; /</span>&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Refs</span><br></pre></td></tr></table></figure>

<h2 id="6-事件-event"><a href="#6-事件-event" class="headerlink" title="6. 事件 event"></a>6. 事件 event</h2><p>可以通过设置原生 dom 组件的 onEventType 属性来监听 dom 事件，例如 onClick, onMouseDown，在加强组件内聚性的同时，避免了传统 html 的全局变量污染</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HandleEvent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123; <span class="attr">liked</span>: <span class="literal">false</span> &#125;</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">liked</span>: !<span class="keyword">this</span>.state.liked &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">let</span> text = <span class="keyword">this</span>.state.liked ? <span class="string">'喜欢'</span> : <span class="string">'不喜欢'</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &lt;p onClick=&#123;this.handleClick&#125;&gt;我 &#123;text&#125; 你.&lt;/p&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> HandleEvent</span><br></pre></td></tr></table></figure>

<p><strong>注意：事件回调函数参数为标准化的事件对象，可以不用考虑 IE</strong></p>
<p>更多事件我们可以一起看<a href="http://reactjs.cn/react/docs/events.html#form-events" target="_blank" rel="noopener">这里</a></p>
<h2 id="7-组件的组合"><a href="#7-组件的组合" class="headerlink" title="7. 组件的组合"></a>7. 组件的组合</h2><h3 id="7-1-受限组件-amp-amp-非受限组件"><a href="#7-1-受限组件-amp-amp-非受限组件" class="headerlink" title="7.1 受限组件 &amp;&amp; 非受限组件"></a>7.1 受限组件 &amp;&amp; 非受限组件</h3><p>受限组件示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;input type="text" value="Hello!" /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非受限组件示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;input type="text" /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-使用自定义的组件"><a href="#7-2-使用自定义的组件" class="headerlink" title="7.2 使用自定义的组件"></a>7.2 使用自定义的组件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComponentA</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;a href=<span class="string">"#"</span>&gt;</span><br><span class="line">        我是组件A</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">      &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class ComponentB extends Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return &lt;a href="#"&gt;我是组件B&lt;/</span>a&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SelfCreateComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;i&gt;</span><br><span class="line">        &lt;ComponentA /&gt;</span><br><span class="line">        &lt;ComponentB /&gt;</span><br><span class="line">      &lt;<span class="regexp">/i&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default SelfCreateComponent</span></span><br></pre></td></tr></table></figure>

<h3 id="7-3-组合-CHILDREN"><a href="#7-3-组合-CHILDREN" class="headerlink" title="7.3 组合 CHILDREN"></a>7.3 组合 CHILDREN</h3><p>自定义组件中可以通过 this.props.children 访问自定义组件的子节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个组件，通过React.Children 拿到组件里面的子元素</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;ul&gt;</span><br><span class="line">        &#123;React.Children.map(<span class="keyword">this</span>.props.children, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> &lt;li&gt;&#123;c&#125;&lt;/li&gt;</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class UseChildrenComponent extends Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;ListComponent&gt;</span></span><br><span class="line"><span class="regexp">        &lt;a href="#"&gt;Facebook&lt;/</span>a&gt;</span><br><span class="line">        &lt;a href=<span class="string">"#"</span>&gt;Google&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">        &lt;a href="#"&gt;SpaceX&lt;/</span>a&gt;</span><br><span class="line">      &lt;<span class="regexp">/ListComponent&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default UseChildrenComponent</span></span><br></pre></td></tr></table></figure>

<h2 id="8-form-表单操作"><a href="#8-form-表单操作" class="headerlink" title="8. form 表单操作"></a>8. form 表单操作</h2><h3 id="8-1-React-表单组件和-html-的不同点"><a href="#8-1-React-表单组件和-html-的不同点" class="headerlink" title="8.1 React 表单组件和 html 的不同点"></a>8.1 React 表单组件和 html 的不同点</h3><ul>
<li>value/checked 属性设置后，用户输入无效</li>
<li>textarea 的值要设置在 value 属性</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;textarea name=<span class="string">"description"</span> value=<span class="string">"This is a description."</span> /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>select 的 value 属性可以是数组，不建议使用 option 的 selected 属性</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;select multiple=&#123;<span class="literal">true</span>&#125; value=&#123;[<span class="string">'B'</span>, <span class="string">'C'</span>]&#125;&gt;</span><br><span class="line">  &lt;option value=<span class="string">"A"</span>&gt;Apple&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">  &lt;option value="B"&gt;Banana&lt;/</span>option&gt;</span><br><span class="line">  &lt;option value=<span class="string">"C"</span>&gt;Cranberry&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>select&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>input/textarea 的 onChange 用户每次输入都会触发（即使不失去焦点）</li>
<li>radio/checkbox/option 点击后触发 onChange</li>
</ul>
<h3 id="8-2-综合表达组件示例"><a href="#8-2-综合表达组件示例" class="headerlink" title="8.2 综合表达组件示例"></a>8.2 综合表达组件示例</h3><p>1.定义复选框组件 Checkboxes</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Checkboxes</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;span&gt;</span><br><span class="line">        A</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleCheck&#125;</span><br><span class="line">          name=<span class="string">"goodCheckbox"</span></span><br><span class="line">          type=<span class="string">"checkbox"</span></span><br><span class="line">          value=<span class="string">"A"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        B</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleCheck&#125;</span><br><span class="line">          name=<span class="string">"goodCheckbox"</span></span><br><span class="line">          type=<span class="string">"checkbox"</span></span><br><span class="line">          value=<span class="string">"B"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        C</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleCheck&#125;</span><br><span class="line">          name=<span class="string">"goodCheckbox"</span></span><br><span class="line">          type=<span class="string">"checkbox"</span></span><br><span class="line">          value=<span class="string">"C"</span></span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default Checkboxes</span></span><br></pre></td></tr></table></figure>

<p>2.定义单选框按钮组 RadioButtons</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RadioButtons</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  saySomething() &#123;</span><br><span class="line">    alert(<span class="string">'我是一个很棒的单选框按钮组'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;span&gt;</span><br><span class="line">        A</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleRadio&#125;</span><br><span class="line">          name=<span class="string">"goodRadio"</span></span><br><span class="line">          type=<span class="string">"radio"</span></span><br><span class="line">          value=<span class="string">"A"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        B</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleRadio&#125;</span><br><span class="line">          name=<span class="string">"goodRadio"</span></span><br><span class="line">          type=<span class="string">"radio"</span></span><br><span class="line">          defaultChecked</span><br><span class="line">          value=<span class="string">"B"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        C</span><br><span class="line">        &lt;input</span><br><span class="line">          onChange=&#123;<span class="keyword">this</span>.props.handleRadio&#125;</span><br><span class="line">          name=<span class="string">"goodRadio"</span></span><br><span class="line">          type=<span class="string">"radio"</span></span><br><span class="line">          value=<span class="string">"C"</span></span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default RadioButtons</span></span><br></pre></td></tr></table></figure>

<p>3.FormApp 组件集成两个组件并处理表单逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> Checkboxes <span class="keyword">from</span> <span class="string">'./Checkboxes'</span></span><br><span class="line"><span class="keyword">import</span> RadioButtons <span class="keyword">from</span> <span class="string">'./RadioButtons'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FormApp</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    inputValue: <span class="string">'请输入...'</span>,</span><br><span class="line">    selectValue: <span class="string">'A'</span>,</span><br><span class="line">    radioValue: <span class="string">'B'</span>,</span><br><span class="line">    checkValues: [],</span><br><span class="line">    textareaValue: <span class="string">'请输入...'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSubmit = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> formData = &#123;</span><br><span class="line">      input: <span class="keyword">this</span>.refs.goodInput.value,</span><br><span class="line">      select: <span class="keyword">this</span>.refs.goodSelect.value,</span><br><span class="line">      textarea: <span class="keyword">this</span>.refs.goodTextarea.value,</span><br><span class="line">      radio: <span class="keyword">this</span>.state.radioValue,</span><br><span class="line">      check: <span class="keyword">this</span>.state.checkValues</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    alert(<span class="string">'您即将提交表单'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'你提交的数据是:'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(formData)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleRadio = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      radioValue: e.target.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleCheck = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> checkValues = <span class="keyword">this</span>.state.checkValues.slice()</span><br><span class="line">    <span class="keyword">let</span> newVal = e.target.value</span><br><span class="line">    <span class="keyword">let</span> index = checkValues.indexOf(newVal)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (index == <span class="number">-1</span>) &#123;</span><br><span class="line">      checkValues.push(newVal)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      checkValues.splice(index, <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      checkValues: checkValues</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form onSubmit=&#123;<span class="keyword">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">        &lt;h3&gt; 请输入内容 &lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input</span></span><br><span class="line"><span class="regexp">          ref="goodInput"</span></span><br><span class="line"><span class="regexp">          type="text"</span></span><br><span class="line"><span class="regexp">          defaultValue=&#123;this.state.inputValue&#125;</span></span><br><span class="line"><span class="regexp">        /</span>&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3&gt; 请选择 &lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;select defaultValue=&#123;this.state.selectValue&#125; ref="goodSelect"&gt;</span></span><br><span class="line"><span class="regexp">          &lt;option value="A"&gt;A&lt;/</span>option&gt;</span><br><span class="line">          &lt;option value=<span class="string">"B"</span>&gt;B&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">          &lt;option value="C"&gt;C&lt;/</span>option&gt;</span><br><span class="line">          &lt;option value=<span class="string">"D"</span>&gt;D&lt;<span class="regexp">/option&gt;</span></span><br><span class="line"><span class="regexp">          &lt;option value="E"&gt;E&lt;/</span>option&gt;</span><br><span class="line">        &lt;<span class="regexp">/select&gt;</span></span><br><span class="line"><span class="regexp">        &lt;br /</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3&gt; 单项选择 &lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;RadioButtons ref="goodRadio" handleRadio=&#123;this.handleRadio&#125; /</span>&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3&gt; 多选按钮 &lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;Checkboxes handleCheck=&#123;this.handleCheck&#125; /</span>&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h3&gt; 反馈建议 &lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">        &lt;textarea</span></span><br><span class="line"><span class="regexp">          defaultValue=&#123;this.state.textareaValue&#125;</span></span><br><span class="line"><span class="regexp">          ref="goodTextarea"</span></span><br><span class="line"><span class="regexp">        &gt;&lt;/</span>textarea&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;button type=<span class="string">"submit"</span>&gt;确认提交&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>form&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> FormApp</span><br></pre></td></tr></table></figure>

<h2 id="9-mixin-共享"><a href="#9-mixin-共享" class="headerlink" title="9. mixin 共享"></a>9. mixin 共享</h2><p>mixin 是一个普通对象，通过 mixin 可以在不同组件间共享代码，使你的 React 程序变得更为可重用。</p>
<p>注意，ES6 语法不支持 mixin 写法，而是可以通过 decorator 去实现代码共享，这里使用 ES5 语法做示例说明。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> SetIntervalMixin = &#123;</span><br><span class="line">  componentWillMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.intervals = []</span><br><span class="line">  &#125;,</span><br><span class="line">  setInterval: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.intervals.push(setInterval.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>))</span><br><span class="line">  &#125;,</span><br><span class="line">  componentWillUnmount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.intervals.forEach(clearInterval)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> MixinDemo = React.createClass(&#123;</span><br><span class="line">  <span class="comment">// Use the mixin</span></span><br><span class="line">  mixins: [SetIntervalMixin],</span><br><span class="line">  getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">seconds</span>: <span class="number">0</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  componentDidMount: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Call a method on the mixin</span></span><br><span class="line">    <span class="keyword">this</span>.setInterval(<span class="keyword">this</span>.tick, <span class="number">1000</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  tick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123; <span class="attr">seconds</span>: <span class="keyword">this</span>.state.seconds + <span class="number">1</span> &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;p&gt;计时器已经运行了： &#123;this.state.seconds&#125; 秒.&lt;/p&gt;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MixinDemo</span><br></pre></td></tr></table></figure>

<p>那么，接下来，我们用 high-order component 的方式来实现 mixin：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Mixin = <span class="function"><span class="params">MixinComponent</span> =&gt;</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">      <span class="keyword">super</span>()</span><br><span class="line">      <span class="keyword">this</span>.state = &#123; <span class="attr">val</span>: <span class="number">0</span> &#125;</span><br><span class="line">      <span class="keyword">this</span>.update = <span class="keyword">this</span>.update.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    update() &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123; <span class="attr">val</span>: <span class="keyword">this</span>.state.val + <span class="number">1</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'will mount...'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;MixinComponent update=&#123;<span class="keyword">this</span>.update&#125; &#123;...this.state&#125; &#123;...this.props&#125; /&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'mounted...'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Button = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;button onClick=&#123;props.update&#125;&gt;</span><br><span class="line">      &#123;props.txt&#125; - &#123;props.val&#125;</span><br><span class="line">    &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Label = props =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;label onMouseMove=&#123;props.update&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.txt&#125; - &#123;props.val&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>label&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ButtonMixed = Mixin(Button)</span><br><span class="line"><span class="keyword">let</span> LabelMixed = Mixin(Label)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mixins</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;ButtonMixed txt=<span class="string">"button"</span> /&gt;</span><br><span class="line">        &lt;LabelMixed txt=<span class="string">"label"</span> /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default Mixins</span></span><br></pre></td></tr></table></figure>

<h2 id="基础部分完结寄语"><a href="#基础部分完结寄语" class="headerlink" title="基础部分完结寄语"></a>基础部分完结寄语</h2><p>总结起来，学习的难度不高，以上内容掌握后，基本能够进行 React 的开发，后续我们继续相关内容的讲解，内容预告：一步步教你如何用 React 写一个简单完整的应用功能。</p>

            </div>
          

    
      <footer class="post-footer">
		
		<div class="post-tags">
		  
			<a href="/tags/React/">React</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2018/03/17/React-router/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">React-router</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
  </nav>

        
  <div class="comments" id="comments">
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2014 -
    
    2019
    <span class="footer-author">GreatDseven.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
